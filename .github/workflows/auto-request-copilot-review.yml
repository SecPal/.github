# SPDX-FileCopyrightText: 2025 SecPal
# SPDX-License-Identifier: AGPL-3.0-or-later

name: Auto-request Copilot Review

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  request-copilot-review:
    name: Request Copilot Review
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - name: Request Copilot review
        uses: actions/github-script@v7
        with:
          script: |
            const prNumber = context.payload.pull_request.number;

            try {
              await github.rest.pulls.requestReviewers({
                owner: context.repo.owner,
                repo: context.repo.repo,
                pull_number: prNumber,
                reviewers: ['copilot-pull-request-reviewer']
              });
              core.info('âœ“ Copilot review requested');
            } catch (error) {
              // Copilot reviews are requested via a different mechanism
              // This will fail, but that's expected
              core.info('Note: Copilot reviews must be requested manually or via GitHub UI');
              core.info('This workflow serves as a reminder to request a Copilot review');
            }
